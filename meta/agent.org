#+TITLE: meta/agent

* Terminal Agent
#+BEGIN_SRC markdown
adapt this agent prompt for Chatgpt codex cli (can write files and run them).
The original version given to you was written for a web agent that couldn't access files so it was not optimal for Codex CLI. Just rewrite the prompt in a markdown code block and change the little details to suit an terminal coding agent. Do not change anything else and also you should absolutely not run this prompt yourself. We want to just refine the prompt for the terminal coding agent.

```speech-to-text
I already gave you the script this agent should run, you know. Simply tell it, you know, to loop, run that script to get 10 new matrix codes, then create directory prompts/slash/number of the batch dot md and write that patch to that file. So at the end, we'll have a subdirectory prompts, and in that sub-directory, we'll have the for each batch one markdown file full of the prompts that the agent wrote for that batch. And the agent should write the prompts themselves. You know, the only part where code is used is when the agent needs to generate the matrix codes. And also, the agent should first, you know, generate the matrix codes for the batch in the prompt directory too. It should use the extension dot matrix. So it will first run the script that you will, you know, you will give it the complete script. I mean, yes, it will first, you know, I to reiterate, I'll tell it to you from the start. The first step is to actually save the script into the file. We'll give it the script, but it needs to save the script into the file. Then it will loop for the number of batches, which is here 40 batches. Then it should run the matrix generator. You know, now it should loop in the loop. It should first run the matrix generator and save its output into the prompt subdirectory number of batch dot matrix. Then it should read this prompt. It should read this matrix code. Then it should write another file, number of the current batch dot md, a markdown file, and it should just write the prompts inside the prompts of this batch inside this file. Okay? And it should keep the numbers for each prompt cumulative. So it should number the prompts and the numbers should be cumulative from 1 to 400. And when it finishes, it should, after the loop finishes, it should simply concatenate all the prompt files in the prompts subdirectory into one total file prompt underline all.md which contains all the generated prompts questions any questions?
```

The script should include the full name of each thing, not refer to the knowledge base.
#+END_SRC

* Template
#+BEGIN_SRC markdown
```speech-to-text
I want to create professional Dixie card images using a pipeline of three components. The first component of the pipeline, which is what we are fixing now, is matrix that generates that card's basic structure and ideas. So this pre-prompt will go to an LLM, and the LLM will write a great detailed prompt that will be given to the final stage. The final stage gets this great prompt and creates an image. Okay, so I want to change the script for the pre-prompts, which is the first stage of this pipeline, such that it takes an output directory and saves the input prompt for the second stage as numbered markdown files. Okay, so it should use a template and repeat that template in each numbered file with the elements and structure that its random matrix generator has created.
```

What I want is a templated pre-prompt, not the code style above. So instead of ` `AR-15 The Mentor + CN-43 Inheritance / Legacy + SL-18 Containment + TX-13 Gemstones & Rust + SC-07 Ladders to Nowhere + EM-08 Tenderness (Gentle Love) + SY-85 The Gate of All Nations + SE-019 Greenhouse parlor with bioluminescent vines + CP-04 Centered one-point perspective with aggressive depth lines + EE-034 Undersea court rebellion against protective father rule`, I want sth like this:
```
Generate a detailed, unique, high-density prompt that I'll feed to a text-to-image model to create a professional illustration for my private Dixit card collection.

,**Target Audience:** Adults (25+).
,**Core Requirement:** High Ambiguity & High Detail. Empty space is a failure. Every card must be a **crowded** visual puzzle.

## Visual Philosophy: "The Frozen Dream"
You are not painting a landscape; you are constructing a **paradox**.
Every prompt must layer **Three Realities**:
1.  **The Subject:** The anchor archetype.
2.  **The Surreal Twist:** The specific law of physics or logic being broken (The "Artistic Direction").
3.  **The Texture:** The *Gankutsuou* style (flat patterns on moving shapes).
4. **The Symbols:** These are the **totemic objects, creatures, and motifs** drawn from world mythology, alchemy, folklore, art history, heraldry, memento mori, religion, literature, celebration, and the collective unconscious. Each prompt should feature at least one as a **central visual motif** woven into the scene architecture.
...

## Mandatory Style Suffix
Append exactly:
```
in the style of Gankutsuou and Gustav Klimt, rich static textile patterns layered over character silhouettes, iridescent gold leaf and jewel tones, texture mapping, ornate Art Nouveau details, collage-like flatness, surreal opulence, sharp distinct lines, psychedelic baroque, maximalist composition, highly detailed background --ar 2:3 --niji 6
```

Your CURRENT TASK is to write a great template. I'll tell you the next task when we finalize the pre-prompt template.

Here is the current random matrix generator. You should see how each random element can be adapted into the template.
#+END_SRC

#+BEGIN_SRC markdown
Thanks. But this is the final task. We need to first collaborate on the template itself and finalize the template. And after that, we need to you know rewrite the generator script.
#+END_SRC

* continue step
#+BEGIN_SRC markdown
Now give me the "continue" prompt that I give to the agent each time it finishes a turn, to continue to the next turn. You can ask the agent to do anything in this prompt (think, review, stay on track, assess, ...). This prompt can heavily influence the agent, as it keeps getting injected each turn. You should repeat all key instructions, including the matrix, as the first message in the context will get truncated as the conversation goes on.

The continue prompt must not hardcode the batch number.
#+END_SRC

#+BEGIN_SRC markdown
Adapt the continue step for this agent:
#+END_SRC

#+BEGIN_SRC markdown
Put it in 
```
sendMessageRepeatedly("", n=180, sleep=100,)
```
#+END_SRC

** randomization
#+BEGIN_SRC markdown
Give a new continue step prompt that explicitly uses Python code to output the 10 random choices from the matrix. Because it is random, there is no need to maintain any cumulative log or any checking, etc. It's completely random, so it's a much easier strategy.

Adjust the code so no element is chosen twice in each batch.
#+END_SRC

#+BEGIN_SRC markdown
This continue step doesn't randomize the matrix elements before the generation, so the chosen elements pattern match together. we need to fix this, you know. For example, for lovers, this current continue prompt almost always chooses intimacy. But we want this to be random for all the matrix elements. That's the whole reason we have designed the matrix, to increase the variety and creativity. 

You can keep a log of all the chosen matrix combinations at the end, a cumulative log at the end of each message after the ten prompts. And when we want to create the next batch, you know, the model should first plan and choose the combinations and check them against the cumulative log. And after choosing the ten matrix elements for the ten prompts, then generate the prompts.
#+END_SRC

* matrix
#+BEGIN_SRC markdown
further expand the matrix, especially the elements, you know, currently we are using the tarot elements. I think we can expand this part by a lot by adding other iconic symbols. 
#+END_SRC

#+BEGIN_SRC markdown
Expand the matrix by some Persian culture elements and symbolism, because you know we are Iranians.  keep the additions a few. I don't want them to dominate the deck. Just a few, you know, iconic Portion elements in the matrix. Also, so don't have anything Islamic in there  but Zoroastrianism is fine. 
#+END_SRC

#+BEGIN_SRC markdown
Don't generate anything. You shouldn't have generated any batches now. We are just refining the prompt. You know, just give me the final updated prompt for the agent.
#+END_SRC

** positive
:PROPERTIES:
:ID:       214b0ed3-e661-46ac-9776-1d56432c0b59
:END:
#+BEGIN_SRC markdown
Our current agent prompt is too dark, you know. I want the prompt to encompass the whole human experience and actually be full of joyful and positive adult experiences, not just the negative one. I want both the negative and the positive.
#+END_SRC
